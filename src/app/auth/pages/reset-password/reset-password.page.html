<div class="min-h-screen flex items-center justify-center bg-gray-50 p-4">
  <div class="w-full max-w-md bg-white shadow rounded-xl p-6">
    <h1 class="text-2xl font-semibold text-gray-900 mb-1">Reset password</h1>
    <p class="text-sm text-gray-600 mb-6">Follow the steps below</p>

    <div class="flex items-center gap-2 text-xs mb-4">
      <span
        class="px-2 py-1 rounded bg-gray-900 text-white"
        [class.opacity-40]="step() !== 'request'"
        >1</span
      >
      <span
        class="px-2 py-1 rounded bg-gray-900 text-white"
        [class.opacity-40]="step() !== 'reset'"
        >2</span
      >
    </div>
    @if (step() === 'request') {
    <form (ngSubmit)="request()" [formGroup]="requestForm" class="space-y-4">
      <app-input-field
        label="Email"
        type="email"
        placeholder="you@example.com"
        controlName="email"
        [error]="requestForm.controls.email.touched && requestForm.controls.email.invalid ? (requestForm.controls.email.errors?.['required'] ? 'Email is required' : (requestForm.controls.email.errors?.['email'] ? 'Enter a valid email' : '')) : ''"
      ></app-input-field>
      <button
        type="submit"
        [disabled]="loading()"
        class="w-full inline-flex justify-center items-center gap-2 rounded-lg bg-gray-900 text-white px-4 py-2.5 hover:bg-gray-800 disabled:opacity-60"
      >
        @if (!loading()) {
        <span>Send reset email</span>
        } @if (loading()) {
        <span class="inline-flex items-center gap-2">
          <span
            class="size-4 border-2 border-white/30 border-t-white rounded-full animate-spin"
          ></span>
          Sending...
        </span>
        }
      </button>
    </form>
    } @if (step() === 'reset') {
    <form (ngSubmit)="reset()" [formGroup]="resetForm" class="space-y-4">
      <app-input-field
        label="Reset Token"
        type="text"
        placeholder="Enter token from email"
        controlName="token"
        [error]="resetForm.controls.token.touched && resetForm.controls.token.invalid ? (resetForm.controls.token.errors?.['required'] ? 'Token is required' : '') : ''"
      ></app-input-field>
      <app-input-field
        label="New password"
        type="password"
        placeholder="••••••••"
        controlName="newPassword"
        [error]="resetForm.controls.newPassword.touched && resetForm.controls.newPassword.invalid ? (resetForm.controls.newPassword.errors?.['required'] ? 'Password is required' : (resetForm.controls.newPassword.errors?.['minlength'] ? 'Minimum 6 characters' : '')) : ''"
      ></app-input-field>

      <button
        type="submit"
        [disabled]="loading()"
        class="w-full inline-flex justify-center items-center gap-2 rounded-lg bg-gray-900 text-white px-4 py-2.5 hover:bg-gray-800 disabled:opacity-60"
      >
        @if (!loading()) {
        <span>Reset password</span>
        } @if (loading()) {
        <span class="inline-flex items-center gap-2">
          <span
            class="size-4 border-2 border-white/30 border-t-white rounded-full animate-spin"
          ></span>
          Resetting...
        </span>
        }
      </button>
    </form>
    }
  </div>
</div>
